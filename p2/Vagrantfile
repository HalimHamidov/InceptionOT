# -*- mode: ruby -*-
# vi: set ft=ruby :

# Master node static IP
MASTER_NODE_IP = "192.168.56.110"
MASTER_NODE_NAME = 'apearlS'

# common config
MEM = 4096
CPU = 4
BOX = "centos/7"
BOX_URL = "/Users/a19229108/Desktop/CentOS-7-x86_64-Vagrant-2004_01.VirtualBox.box"
BOX_AUTO_UPDATE = false

$CREAT_SYNC_DIRECTORY = <<-SHELL
  sudo mkdir /media/configs
SHELL


Vagrant.configure("2") do |config|

	config.vm.box = BOX
	config.vm.box_url = BOX_URL
	#config.vm.box_check_update = BOX_AUTO_UPDATE
	# config.vm.provision "shell", inline: $CREAT_SYNC_DIRECTORY
	# чтобы обновилось и добавило возможность монтировать директории, устанавливать синхронизацию
	config.vbguest.installer_options = { allow_kernel_upgrade: true }

	config.vm.provider "virtualbox" do |v|
		v.memory = MEM
		v.cpus = CPU
	end

	config.vm.define MASTER_NODE_NAME do |master|
		master.vm.hostname = MASTER_NODE_NAME
		master.vm.network :private_network, ip: MASTER_NODE_IP

		master.vm.synced_folder ".", "/media/", type: "rsync"
    	master.vm.provision "shell", privileged: true, path: "scripts/server.sh", args: [MASTER_NODE_IP]
		master.vm.provider "virtualbox" do |v|
			v.name = MASTER_NODE_NAME
    end
  end
end
